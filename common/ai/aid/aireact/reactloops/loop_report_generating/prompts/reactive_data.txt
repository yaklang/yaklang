## âš ï¸ å†™æŠ¥å‘Šæ—¶å¿…é¡»ä½¿ç”¨ä»¥ä¸‹æ ¼å¼

å½“ä½ ä½¿ç”¨ `write_report` æ—¶ï¼Œå¿…é¡»è¿™æ ·è¾“å‡ºï¼š
```
{"@action": "write_report", "human_readable_thought": "..."}

<|GEN_REPORT_{{ .Nonce }}|>
ä½ çš„æŠ¥å‘Šå†…å®¹...
<|GEN_REPORT_END_{{ .Nonce }}|>
```

**æ³¨æ„ï¼šNonce æ˜¯ `{{ .Nonce }}`ï¼Œä½ å¿…é¡»ä½¿ç”¨ `<|GEN_REPORT_{{ .Nonce }}|>` å’Œ `<|GEN_REPORT_END_{{ .Nonce }}|>` åŒ…è£¹å†…å®¹ï¼**

---

## å½“å‰æŠ¥å‘ŠçŠ¶æ€

### ç”¨æˆ·éœ€æ±‚
<|USER_REQUIREMENTS_{{ .Nonce }}|>
{{ .UserRequirements }}
<|USER_REQUIREMENTS_END_{{ .Nonce }}|>

### æŠ¥å‘Šæ–‡ä»¶
æ–‡ä»¶è·¯å¾„ï¼š{{ .Filename }}

### ğŸ“Š æŠ¥å‘Šè§†å›¾ä¿¡æ¯
{{ if gt .TotalLines 0 }}
- **å½“å‰æ˜¾ç¤º**: ç¬¬ {{ .OffsetLine }} - {{ .EndLine }} è¡Œ (å…± {{ .TotalLines }} è¡Œ)
- **å†…å®¹å¤§å°**: æ˜¾ç¤º {{ .VisibleSize }} / {{ .TotalSize }} å­—èŠ‚ (é™åˆ¶ {{ .ShowSize }} å­—èŠ‚)
{{ if .HasPrevContent }}- â¬†ï¸ **ä¸Šæ–¹è¿˜æœ‰å†…å®¹** - ä½¿ç”¨ `change_view_offset` è®¾ç½® `offset_line=1` å›åˆ°å¼€å¤´{{ end }}
{{ if .HasMoreContent }}- â¬‡ï¸ **ä¸‹æ–¹è¿˜æœ‰æ›´å¤šå†…å®¹** - ä½¿ç”¨ `change_view_offset` è®¾ç½® `offset_line={{ .EndLine }}` ç»§ç»­æŸ¥çœ‹{{ end }}
{{ else }}
- æŠ¥å‘Šä¸ºç©ºï¼Œè¯·å…ˆåˆ›å»ºæŠ¥å‘Š
{{ end }}

### å½“å‰æŠ¥å‘Šå†…å®¹ï¼ˆå¸¦è¡Œå·ï¼‰
{{ if .CurrentReportWithLineNumber }}
<|REPORT_CONTENT_{{ .Nonce }}|>
{{ .CurrentReportWithLineNumber }}
<|REPORT_CONTENT_END_{{ .Nonce }}|>
{{ else }}
ï¼ˆæŠ¥å‘Šä¸ºç©ºï¼‰
{{ end }}

### å·²æ”¶é›†çš„å‚è€ƒèµ„æ–™
{{ if .CollectedReferences }}
<|COLLECTED_REFERENCES_{{ .Nonce }}|>
{{ .CollectedReferences }}
<|COLLECTED_REFERENCES_END_{{ .Nonce }}|>
{{ else }}
æš‚æ— æ”¶é›†çš„å‚è€ƒèµ„æ–™ï¼Œè¯·å…ˆä½¿ç”¨æŸ¥èµ„æ–™å·¥å…·æ”¶é›†ä¿¡æ¯ã€‚
{{ end }}

### å¯ç”¨å‚è€ƒæ–‡ä»¶
{{ if .AvailableFiles }}
{{ .AvailableFiles }}
{{ else }}
æš‚æ— å¯ç”¨çš„å‚è€ƒæ–‡ä»¶ã€‚
{{ end }}

### å¯ç”¨çŸ¥è¯†åº“
{{ if .AvailableKnowledgeBases }}
{{ .AvailableKnowledgeBases }}
{{ else }}
æš‚æ— å¯ç”¨çš„çŸ¥è¯†åº“ã€‚
{{ end }}

{{ if .FeedbackMessages }}
### åé¦ˆä¿¡æ¯
<|FEEDBACK_{{ .Nonce }}|>
{{ .FeedbackMessages }}
<|FEEDBACK_END_{{ .Nonce }}|>
{{ end }}

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨æŒ‡å—

### å¦‚æœæŠ¥å‘Šä¸ºç©º
1. å…ˆä½¿ç”¨æŸ¥èµ„æ–™å·¥å…·æ”¶é›†ä¿¡æ¯ï¼š
   - `read_reference_file` é˜…è¯»å‚è€ƒæ–‡ä»¶
   - `grep_reference` æœç´¢å…³é”®è¯
   - `search_knowledge` çŸ¥è¯†åº“æœç´¢
2. æ”¶é›†è¶³å¤Ÿèµ„æ–™åä½¿ç”¨ `write_report` åˆ›å»ºåˆç¨¿

### å¦‚æœæŠ¥å‘Šå·²æœ‰å†…å®¹
1. æ£€æŸ¥æ˜¯å¦éœ€è¦è¡¥å……æ›´å¤šèµ„æ–™
2. ä½¿ç”¨ `modify_section` ä¿®æ”¹ç°æœ‰å†…å®¹
3. ä½¿ç”¨ `insert_section` æ·»åŠ æ–°ç« èŠ‚
4. ä½¿ç”¨ `delete_section` åˆ é™¤å†—ä½™å†…å®¹

### ğŸ“– å¤§æŠ¥å‘Šå¯¼èˆªï¼ˆé‡è¦ï¼ï¼‰
å½“æŠ¥å‘Šå†…å®¹å¾ˆå¤§æ—¶ï¼Œåªä¼šæ˜¾ç¤ºéƒ¨åˆ†å†…å®¹ã€‚ä½¿ç”¨ `change_view_offset` æ¥å¯¼èˆªï¼š
- **æŸ¥çœ‹å¼€å¤´**: `{"@action": "change_view_offset", "offset_line": 1}`
- **ç»§ç»­å¾€ä¸‹çœ‹**: `{"@action": "change_view_offset", "offset_line": {{ .EndLine }}}`
- **è·³è½¬åˆ°æŒ‡å®šè¡Œ**: `{"@action": "change_view_offset", "offset_line": ç›®æ ‡è¡Œå·}`

### ä¿®æ”¹æ“ä½œè¯´æ˜
- è¡Œå·ä» 1 å¼€å§‹è®¡æ•°
- ä¿®æ”¹èŒƒå›´å¿…é¡»æŒ‡å®š start_line å’Œ end_line
- æ’å…¥æ—¶æŒ‡å®š after_lineï¼ˆåœ¨è¯¥è¡Œä¹‹åæ’å…¥ï¼‰
- æ¯æ¬¡æ“ä½œåä¼šè‡ªåŠ¨æ›´æ–°è¡Œå·

