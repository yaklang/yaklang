# Background
Current Time: {{ .CurrentTime }}
OS/Arch: {{ .OSArch }}
{{ if .WorkingDir }}working dir: {{ .WorkingDir }}{{ end }}
{{ if .WorkingDirGlance }}working dir glance: {{ .WorkingDirGlance }}{{ end }}
{{ if .DynamicContext }}{{ .DynamicContext }} {{end}}

{{ if .ConversationMemory }}# Conversation Memory
{{ .ConversationMemory }}
{{ end }}

{{ if .Timeline }}# Timeline Memory
{{ .Timeline }}
{{ end }}

# Current AI Blueprint
You are currently using the blueprint: {{ .CurrentBlueprint.ForgeName }}
Description: {{ .CurrentBlueprint.Description }}

{{ if .OldParams }}# Previous Parameters Used
The parameters that were used with the current blueprint:
<|OLD_PARAMS_{{ .Nonce }}|>
{{ .OldParams }}
<|OLD_PARAMS_END{{ .Nonce }}|>
{{ end }}

{{ if .ExtraPrompt }}# Additional Context
{{ .ExtraPrompt }}
{{ end }}

# Available AI Blueprints
Here are the available AI blueprints you can switch to:
{{ .ForgeList }}

# Task
Based on the current context, conversation history, and the previous blueprint execution, you need to select a different AI blueprint that would be more suitable for continuing or completing the user's task.

Consider:
- The original user query: {{ .UserQuery }}
- What was attempted with the current blueprint
- What results or issues occurred (if any)
- How a different blueprint might better address the task

{{ if eq .Language "zh" }}LANGUAGE: Please respond in Chinese (中文) unless specifically asked otherwise.{{ else }}LANGUAGE: Please respond in English unless specifically asked otherwise.{{ end }}

**你必须严格按照下面的 Schema 输出一个 JSON 对象，不得包含任何其他文字。**

```schema
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": [
    "@action",
    "reasoning",
    "new_blueprint"
  ],
  "properties": {
    "@action": {
      "const": "change-ai-blueprint",
      "description": "set '@action' can help the AI identify the output json object",
      "type": "string"
    },
    "reasoning": {
      "description": "切换这个新的 Blueprint/Forge 的原因",
      "type": "string"
    },
    "new_blueprint": {
      "description": "切换成新的 Blueprint 的名称",
      "type": "string"
    }
  },
  "additionalProperties": true
}
```
