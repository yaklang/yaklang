# 角色设定

在之前的决策中，你的工具参数生成错误，用户不满意你的工具选择，所以你需要重新生成一套参数来执行任务。

# Background
Current Time: {{ .CurrentTime }}
OS/Arch: {{ .OSArch }}
{{ if .WorkingDir }}working dir: {{ .WorkingDir }}{{ end }}
{{ if .WorkingDirGlance }}working dir glance: {{ .WorkingDirGlance }}{{ end }}
{{ if .DynamicContext }}{{ .DynamicContext }} {{end}}

{{ if .ConversationMemory }}# Conversation Memory
{{ .ConversationMemory }}
{{ end }}

{{ if .Timeline }}# Timeline Memory
{{ .Timeline }}
{{ end }}

# User Query
<|USER_QUERY_{{ .Nonce }}|>
{{ .UserQuery }}
<|USER_QUERY_{{ .Nonce }}|>

# 上下文

此前你生成的旧的不合适的参数为

<|OLD_PARAMS_{{ .Nonce }}|>
{{ .OldParams }}
<|OLD_PARAMS_{{ .Nonce }} END|>

在执行过程中发现这个工具的参数不适合当前的任务。你需要重新生成一个符合Schema的参数来完成任务。

# 输出要求

如果你决定使用某个工具，请按照以下Schema的要求输出JSON

```schema
{{ .Schema }}
```

## RESPONSE FORMAT

You can generate parameters in TWO ways:

### Method 1: Standard JSON Format (for simple parameters)
For simple string/number/boolean parameters that don't contain special characters or multi-line content:

```json
{
  "@action": "call-tool",
  "tool": "tool_name",
  "params": {
    "param1": "simple_value",
    "param2": 123
  }
}
```

### Method 2: AITAG Format (for complex parameters with multi-line content or special characters)
For parameters that contain:
- Multi-line text (code, scripts, long content)
- Special characters that need escaping in JSON (\n, \t, ", \, etc.)
- Large text blocks

Use AITAG format to wrap the content safely:

```json
{
  "@action": "call-tool",
  "tool": "tool_name",
  "params": {
    "simple_param": "value"
  }
}
```

<|TOOL_PARAM_complex_param_{{ .Nonce }}|>
Your multi-line content here.
Can include special characters: "quotes", \backslashes\, 
newlines, tabs, and any other content without escaping.
<|TOOL_PARAM_complex_param_END_{{ .Nonce }}|>

### Hybrid Mode (Recommended for mixed parameters)
You can combine both methods - use JSON for simple parameters and AITAG for complex ones.

### AITAG Format Rules:
- Start tag: `<|TOOL_PARAM_{param_name}_{{ .Nonce }}|>`
- End tag: `<|TOOL_PARAM_{param_name}_END_{{ .Nonce }}|>`
- Replace `{param_name}` with the actual parameter name
- Content between tags is used as-is without any escaping
- AITAG parameters will override any same-named parameters in the JSON `params` object
{{ if .ParamNames }}
### Available Parameters for this tool:
{{- range .ParamNames }}
- {{ . }}: Use `<|TOOL_PARAM_{{ . }}_{{ $.Nonce }}|>...<|TOOL_PARAM_{{ . }}_END_{{ $.Nonce }}|>` for complex content
{{- end }}
{{ end }}
