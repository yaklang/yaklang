nucleiPoC = MITM_PARAMS["CURRENT_NUCLEI_PLUGIN"]
customVars = "INJECTED_VARS" in MITM_PARAMS ? MITM_PARAMS["INJECTED_VARS"] : nil
if customVars != nil {
    log.Info("found injected vars for nuclei: %v", customVars)
}

execNuclei = func(target) {
    nucleiPocName = nucleiPoC.ScriptName
	// log.Info("start to execute: %s [%v]", nucleiPocName, target)
    var res
    var err
    if customVars == nil {
        res, err = nuclei.Scan(
            target,
            nuclei.exactTemplateIns(nucleiPoC),
            nuclei.timeout(10),
        )
    } else {
        res, err = nuclei.Scan(
            target,
            nuclei.exactTemplateIns(nucleiPoC),
            nuclei.timeout(10),
            nuclei.vars(customVars),
        )
    }
	if err != nil {
		yakit.Error("failed to scan[%v]: %s", target, err)
		return
	}
    // log.Info("waiting results for: %v to: %v", nucleiPocName, target)
	for pocVul = range res {
		yakit.Output(pocVul)
		yakit.Output(nuclei.PocVulToRisk(pocVul))
	}
}